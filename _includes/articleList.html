{% capture locale %}{{ page.url | truncate: 3, "" | remove: "/" }}{% endcapture %}
{% unless site.authorized_locales contains locale %}
{% assign locale = site.default_locale %}
{% endunless %}

{% if include.type == "archive" %}

{% if site.categories[locale] == nil %}
	<p><em>{{ site.data.i18n[locale].noArticles }}</em></p>
{% else %}

<ul class="noBullet">
{% assign oldYear = "" %}
{% for post in site.categories[locale] %}

{% if locale == "de" %}
	{% assign date = post.date | date: '%d.%m.' %}
{% else %}
	{% assign date = post.date | date: '%d/%m' %}
{% endif %}

{% assign year = post.date | date: '%Y' %}
{% if year != oldYear %}
{% unless forloop.first %}</ul>{% endunless %}<li><em>{{ year }}</em><ul class="noBullet">
{% endif %}
<li>
	<div class="articleList">	
		<span class="left">{{ date }}:</span>
		<span class="headline narrow">
			<a href="{{ post.url }}">{{ post.title }}</a>    
		</span> 
	</div>
</li>
{% assign oldYear = year %}

{% endfor %}
</ul>
{% endif %}

{% elsif include.type == "recent" %}

{% if site.categories[locale] == nil %}
	<em>{{ site.data.i18n[locale].noArticles }}</em>
{% else %}
	{% for post in site.categories[locale] limit: 3 %}

	{% if locale == "de" %}
	{% assign date = post.date | date: '%d.%m.%Y' %}
	{% else %}
	{% assign date = post.date | date: '%d/%m/%Y' %}
	{% endif %}

<div class="articleList">
	<span class="left">{{ date }}:</span>
	<span class="headline">
		<a href="{{ post.url }}">{{ post.title }}</a>
		{% if post.description %}
		<p>
			{{ post.description }}
		</p>
		{% else %}
		<p>
			{{ site.data.i18n[locale].noDescription }}
		</p>
		{% endif %}
	</span>	
</div>

	{% endfor %}
	{% endif %}
{% endif %}