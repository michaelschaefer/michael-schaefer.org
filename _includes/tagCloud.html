{% comment %} build tag list {% endcomment %}
{% assign tagList = "" %}
{% for tag in site.tags %}	
	{% assign tagName = tag | first %}

	{% assign tagCount = 0 %}
	{% for post in site.tags[tagName] %}
		{% assign category = post.url | truncate: 3, "" | remove: "/" %}		
		{% if category == language %}
			{% assign tagCount = tagCount | plus: 1 %}
		{% endif %}
	{% endfor %}	

	{% if tagCount > 0 %}
		{% assign tmp = tag[0] | downcase %}
		{% assign tagList = tagList | append: tmp %}
		{% assign tagList = tagList | append: ";" %}
		{% assign tagList = tagList | append: tag[0] %}
		{% assign tagList = tagList | append: ";" %}
		{% assign tagList = tagList | append: tagCount %}
		{% unless forloop.last %}{% assign tagList = tagList | append: "," %}{% endunless %}
	{% endif %}
{% endfor %}
{% assign tagList = tagList | split: ',' | sort %}


{% comment %} show result {% endcomment %}
{% assign tagCloudData = site.data.i18n[language]['tag'] %}
{% if tagList.size == 0 %}
	{{ tagCloudData['strings'].empty }}
{% else %}	
	{% for tag in tagList %}
		{% assign tagPair = tag | split: ';' %}
		{% capture title %}{{ tagPair[2] }}&nbsp;{% if tagPair[2] == "1" %}{{ tagCloudData['strings'].article }}{% else %}{{ tagCloudData['strings'].articles }}{% endif %}{% endcapture %}
		{% if forloop.first %}{% else %}-->{% endif %}<a class="tag" href="{{ tagCloudData.url }}/{{ tagPair[0] | cgi_escape }}/">{{ tagPair[0] }}</a>{% if forloop.last %}{% else %}<!--{% endif %}
	{% endfor %}
{% endif %}